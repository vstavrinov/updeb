<!-- Creator     : groff version 1.22.3 -->
<!-- CreationDate: Fri Jul 10 14:18:28 2015 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>updeb</title>

</head>
<body>

<h1 align="center">updeb</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#EXAMPLE">EXAMPLE</a><br>
<a href="#FILES">FILES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>updeb</b> -
Upgrade Debian system non-interactively.</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>updeb</b>
[<b>-ursmdhvV</b>] [<b>-c</b> <i>CONFIG</i>] [<b>-t</b>
<i>MAILTO</i>]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This script
will upgrade running debian system and mail the result: what
was upgraded, from what version to what and for what period
of time. The actual upgrade will be done only if all index
files will be successfully updated, all required packages
will be successfully downloaded, and finally only if the
simulating of upgrade will be finished without errors. All
old configuration files are preserved and can be compared to
new *.dpkg-dist files. If any error occur, this will be
mailed to You. The auto roll back and health check features
allows to get system in old state if upgrade or test fails.
It is intended to be used as cron job.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p style="margin-top: 1em"><b>-u</b></p></td>
<td width="8%"></td>
<td width="78%">


<p style="margin-top: 1em">Upgrade debian system</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-r</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Debian upgrade report to stdout only if system changed
since last upgrade</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-m</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Mail upgrade report</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-s</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Update the list of packages versions (called
&quot;snapshot&quot;). This is snapshot what current state
of the system is compared to. Its time stamp is the start of
the report period. Note: if this option supplied alone with
<b>-u</b> (i.e. upgrade) the actual update of the snapshot
will be done only if the option <b>-m</b> (mail to) is
present too and the system changed, i.e. at least one
package was upgraded, installed or removed. This is not true
for stand alone option: i.e. <b>updeb -s</b> will update
snapshot in any way.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-S</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Show available snapshots in POINT in time.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>-B POINT</b></p>

<p style="margin-left:22%;">List what to do to roll back to
POINT in time (see <b>-S</b> option for POINT).</p>

<p style="margin-left:11%;"><b>-b POINT</b></p>

<p style="margin-left:22%;">Roll back to POINT in time (see
<b>-S</b> option for POINT).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-a</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Auto rollback if upgrade fails</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-e</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Health check and auto rollback if it fails. You sould
define test commands in healthcheck function.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>-c</b> <i>CONFIG</i></p>

<p style="margin-left:22%;">Set the configuration file.
Default /etc/<b>updeb</b>/updebrc</p>

<p style="margin-left:11%;"><b>-t</b> <i>MAILTO</i></p>

<p style="margin-left:22%;">Recipient of upgrade report.
Default root</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-v</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Verbose mode. This imply the verbosity of log file only,
but not report</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-d</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Debug mode. Set the shell options: set <b>-x -v</b>.
Don&rsquo;t use it in cron job</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-h</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Help</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-V</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Version and copyright</p></td></tr>
</table>

<h2>EXAMPLE
<a name="EXAMPLE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Typically this
script is running by cron daemon every night. You can add to
crontab something like this:</p>

<p style="margin-left:11%; margin-top: 1em">30 1 * * * root
updeb &minus;ums <br>
This will upgrade Your system every night at 01:30 and if
system changed, update snapshot and send report to You.</p>

<h2>FILES
<a name="FILES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>/etc/updeb/updebrc</b></p>

<p style="margin-left:22%;">Main configuration file setting
shell variables for such thing as address, log file,
verbosity, cache cleaning and upgrade mode. In turn it
sources the file /etc/<b>updeb</b>/updebrc.local, where You
can redefine all of them, leaving main config untouched.</p>


<p style="margin-left:11%;"><b>/etc/updeb/updebrc.local</b></p>

<p style="margin-left:22%;">Local configuration file,
sourced by main config. Use it for custom setting,
overriding ones from main config.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>updebrc</b>(5),
<b>apt-get</b>(8), <b>dpkg</b>(8)</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Vladimir
Stavrinov &lt;vstavrinov@gmail.com&gt;</p>
<hr>
</body>
</html>
